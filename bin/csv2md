#! /usr/bin/env ruby
# 参考: https://kannokanno.hatenablog.com/entry/2017/05/30/000935

require 'csv'
require 'optparse'

def print_to_table(rows)
  header   = rows[0]
  contents = rows[1..-1]

  puts "| " + header.join(" | ") + " |"
  puts "| " + Array.new(header.length, "---").join(" | ") + " |"
  contents.each do |items|
    puts "| " + items.join(" | ") + " |"
  end
end

opt = OptionParser.new
col_sep = ','
opt.on('-s VAL') { |val| col_sep = val }
opt.on('-t') { col_sep = "\t" }
opt.parse!(ARGV)

rows = CSV.parse(STDIN.read, col_sep: col_sep)

print_to_table(rows)

