---
name: タスク技術設計
description: タスクの技術アーキテクチャを詳細設計し、実装可能なレベルまで具体化します。
---

$1

タスクの技術アーキテクチャを詳細設計し、実装可能なレベルまで具体化します。

**注意**
このコマンドは、前段のステップで決定した高レベルな解決アプローチを、詳細な技術仕様に落とし込むものです。
実装に必要な具体的な設計情報を整理することが目的です。

## 目的

- 前段で確定した方針を、実装可能な技術設計に具体化する
- 実装者が迷わず手を動かせる粒度まで構成・IF・データ設計を明示する

## 入力で確認すること

- 対象タスクのリンクと概要（Notion/GitHub Issue 等）
- 現行システムの関連部分（構成図、コード、依存サービス）
- 技術的制約・非機能要件（性能/SLO/セキュリティ/可用性/コスト）
- スコープの前提と除外範囲、外部依存やリスク
- 情報不足があれば、質問を箇条書きするか仮置き前提として明示する

## 出力の要件

- `## 設計` セクションにそのまま貼れる本文のみを出力
- 構成: アーキテクチャ構成 / クラス設計 / データベース設計（必要時）/ API設計（必要時）/ UI設計（必要時）/ 設定・デプロイ（必要時）
- ですます調。箇条書き末尾に句点を付けない。句点ごとに改行し、平易な日本語で記載
- 一般論は避け、今回の実装に固有な構成・IF・データ定義・設定を具体的に書く
- 不要なセクションは明示的にスキップし、未決・依存・リスクは簡潔に記載

## 手順

1. **前提整理**: タスクの背景情報・方針等を確認し、スコープ・制約・非機能要件・除外範囲・外部依存をまとめる
2. **構成設計**: コンポーネント構成、データ/処理フロー、既存連携方法を決める
3. **詳細化**: 必要なファイル/クラス/メソッド、DB定義、API/イベント、UI変更点、設定・デプロイを列挙し役割と目的を説明する
4. **未決の明示**: 情報不足や決定待ち、外部リスクを箇条書きで記載する
5. **書式整形**: 下記テンプレートに沿って `## 設計` を作成し、不要セクションは省く
6. **自己チェック**: チェックポイントで粒度・固有性・未決事項・文体を確認する

## 出力例 (テンプレート)

```
## 設計

### アーキテクチャ構成
（この実装がどのようなコンポーネントで構成されるかを説明）
（既存のシステムとの連携方法も含める）
（データの流れや処理の流れも説明）

### クラス設計

- app/
  - controllers/
    - xxx_controller.rb
      - （このファイルで実装する内容と役割を説明）
      - #show
        - （実装予定のメソッドは全て列挙する必要はありません。重要だと判断したメソッドのみ列挙してください）
        - （実装内容が複雑なメソッドであれば説明を簡潔に記載してください。単純な処理であれば説明は不要です）
        - （文がごちゃつくので、引数の詳細を書いたりその説明をしたりする必要はありません）
  - models/
    - ...
  - views/
    - ...
  - ...

### データベース設計
- xxx テーブル
  - （このテーブルを作成・変更する理由と用途を説明）
  - （他テーブルとの関係性、インデックス設計も記載）
  - カラム設計:
    - column_name: データ型 - 用途説明
    - ...
- yyy テーブル

（データベースに無関係な実装の場合はこのセクションをスキップ）
（この実装に関係しないテーブルについては説明不要）

### API設計
- POST /api/xxx
  - （このエンドポイントの用途と処理内容を説明）
  - リクエスト: { "param": "value" }
  - レスポンス: { "result": "success" }
- GET /api/yyy

（APIが不要な実装の場合はこのセクションをスキップ）

### UI設計
（フロントエンド実装が必要な場合、どのようなコンポーネント・画面を実装するかを記載）
（既存UIの変更点も含める）
（UI実装が不要な場合はこのセクションをスキップ）

### 設定・デプロイ
（実装に必要な環境設定、デプロイ手順、マイグレーション等を記載）
（既存システムへの影響も含める）
（設定・デプロイに関係しない場合はこのセクションをスキップ）
```

## チェックポイント

- [ ] 方針を実装可能な設計に落とし込めているか
- [ ] スコープ前提と除外範囲、外部依存・リスクが明記されているか
- [ ] 実装者が迷わない粒度で構成・IF・データ・設定が具体化されているか
- [ ] 不要セクションを省き、必要セクションは過不足なく埋まっているか
- [ ] 一般論ではなく今回特有の内容にフォーカスしているか
- [ ] ですます調で、箇条書き末尾に句点がないか
- [ ] 未決事項が明示され、実装タスクとしてタスク化できる状態か
