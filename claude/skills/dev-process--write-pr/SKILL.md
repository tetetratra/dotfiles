---
name: write-pr
description: PRの背景・目的、変更内容、動作確認を整理してPRを作成・更新する。
---

PRの背景・目的、変更内容、動作確認のセクションを体系的に作成し、PRを作成・更新します。
必要に応じて主要な変更箇所に補足コメントを追加します。

## 手順

- 情報整理
  - これまでに以下が未整理の場合、まずそれらを整理してください
    - 変更内容の技術的な目的：「このPRは何をするものか？」を明確にします
    - 根本目的：「なぜその技術的変更が必要なのか？（どのようなビジネス上や運用上の課題があったのか）」を明確にします

- 目的の整理
  - knowledge--purpose-structuring スキルの指針に従って判断してください

- 変更内容整理
  - PRの技術的変更内容のうち、主要なポイントを整理してください
    - 細かすぎる変更点は省略すること
    - 特定の手順に則って変更を加えた場合は、行った手順とその説明も記載すること

良い例（適度な粒度）：
```
## 変更内容
- date型のサポートを追加
- 管理画面UIの改善
- ...
```

悪い例（詳細を書きすぎ）：
```
## 変更内容
### 1. date型のサポート追加
- schemaに`date`型を追加
- `str_to_value`/`value_to_str`でdate型の変換処理を実装
  - 文字列からTimeオブジェクトへの変換
  - TimeオブジェクトからISO8601形式文字列への変換
- date型のバリデーション追加（Time/ActiveSupport::TimeWithZoneの型チェック）
- ...

### 2. 管理画面UIの改善
- 表示を日本語化（文字列、真偽値、整数、日付）し、英語名も併記
- ...
### 3. ...
```

- 動作確認の整理
 - 前段までに動作確認方法を検討済みの場合、それに従います
 - 動作確認方法を未検討の場合、動作確認方法を検討してください
   - 開発環境とQA環境での動作確認内容を検討してください
 - 例のようなフォーマットで `## 動作確認` セクションに記載する文章を考えてください
   - チェックボックスについて、未実施の場合はチェックを空にしてください。実施済みの場合はチェックを入れてください
   - この作業において未実施の動作確認を実施する必要はありません

例：
```
## 動作確認

開発環境で以下を確認します

- [x] 管理画面での日時の入力が正しく動作することを確認
- [x] 入力した日時がxxの画面に正しく反映されることを確認

QA環境で以下を確認します

- [ ] 管理画面での日時の入力が正しく動作することを確認
- [ ] 入力した日時がxxの画面に正しく反映されることを確認
```

- 補足コメント検討
  - 「補足情報の提示有無の判断基準」に基づいて、PRの変更内容について、補足情報が必要な箇所を洗い出してください
  - 各箇所について、「補足情報の書き方」に基づいて、文章として整理してください

- 反映内容の確認
  - 上記までにで整理した内容を、ユーザーに提示し、文章や内容のレビューを依頼してください
  - OKが出たら次の「反映」ステップに進みます

- 反映
  - OKが出たら、以下の手順でPRを作成または更新してください
    - 反映・更新手順
      - PR未作成の場合
        - `gh pr create --draft` で必ずdraftとして作成する
        - レビュワーは追加しない
        - デフォルトのPRテンプレートを使用する
        - 他のセクション（チェックリストなど）には一切手を加えない
      - PR作成済みの場合
        - `gh pr edit` コマンドを使用してPRの概要欄を更新する
        - 既にセクションがあればそれを使い、無ければ新規に設け、整理した内容で追加または更新する
      - 整理した補足情報を、コメント・インラインコメントとして追加してください

### 補足情報の提示有無の判断基準
knowledge--pr-supplemental-info スキルの指針に従って判断してください。

### 補足情報の書き方
knowledge--pr-supplemental-info スキルの指針に従って判断してください。

## チェックポイント
- [ ] PR未作成の場合、`gh pr create --draft` で作成されているか
- [ ] PR未作成の場合、レビュワーが追加されていないか
- [ ] PR未作成の場合、デフォルトテンプレートが使用され、指定セクション以外に手を加えていないか
- [ ] PR作成済みの場合、`gh pr edit` コマンドで更新されているか
